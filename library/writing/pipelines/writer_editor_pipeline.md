# 简宁（writer-editor）写作流水线

更新时间：2026-02-07

目标：在“质量优先、成本可控”的前提下，稳定产出可直接发布的中文稿件。

## 总流程（默认）
1) 事实核验与素材
   - 必备：sources.md（权威链接 / 数据要点 / 引用片段）
   - 要求：正文不混入核验链接；统一在附录 sources.md 中列出
2) 大纲生成（Outline）
   - 基于题目 + sources 要点 → 输出 5–9 个一级段落
   - 校验：逻辑顺序、信息密度、避免过度承诺
3) 分段成文（Per-section Drafts）
   - 每段 250–500 字；引用数据处加“[数据：…]”标注，方便后续清理
   - 控制：单段 tokens ≤ 700，超出则拆分
4) 合并与润色（Merge & Polish）
   - 统一人称/时态/用词；消除重复与口水词
   - 生成：标题、导语（≤60字）、小结（3要点）、CTA（可选）
5) 终稿检查（Final QA）
   - 事实对齐：与 sources 一致；删除“[数据：…]”标注
   - 一致性：术语统一、时间线正确
   - 可读性：短句优先；段落 ≤ 6 行

## 模型与参数（默认）
- 路由（强→弱，降级：质量阈值/预算触发）
  1. openai/gpt-5（主力）
  2. google/gemini-2.5-pro（多模态/长文性价比）
  3. google/gemini-2.5-flash（草稿/改写/批量）
  4. openai/gpt-4o-mini（低成本兜底）
- 采样：temperature 0.7、top_p 0.9
- 分段长度：单段 250–500 字，≤700 tokens

## 成本控制
- 预算上限（每稿）：
  - soft cap：$0.80 → 触发降级到 2.5-pro
  - hard cap：$1.20 → 触发降级到 2.5-flash/4o-mini，并停止进一步扩写
- 缓存：相同段落/提示启用缓存（不重复计费）
- 批处理：可延迟的大纲/润色步骤允许使用 Flex/Batch 档（更便宜）

## 质量门槛
- sources 必填：无 sources 不开写
- 事实一致：任何数字/引语必须可在 sources 中验证
- 可测性：导语阐明“读者将获得什么”；小结 3 要点必填

## 产出与存档
- 目录：`/Users/apple/clawd/library/writing/` 下按日期/主题建文件夹
- 文件：
  - `draft_outline.md`（大纲）
  - `draft_sections/`（逐段草稿）
  - `final.md`（可直接发布的正文）
  - `sources.md`（核验/参考，不混入正文）
- 版本：每次大改保留副本，支持 diff 回看与回滚

## 快速使用
- 给出主题/链接 → 我：拉取/核验 → 出大纲 → 分段 → 合并润色 → 交付 final.md + sources.md
